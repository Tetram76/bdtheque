<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="org.tetram.bdtheque.data.dao.mappers.ImageMapper">
    <resultMap id="ImageLite" type="beanImageLite">
        <result column="CategorieImage" property="categorie"/>
    </resultMap>
    <resultMap id="PhotoLite" type="beanPhotoLite" extends="ImageLite">
        <id column="id_photo" property="id"/>
        <result column="FichierPhoto" property="newNom"/>
        <result column="StockagePhoto" property="newStockee"/>
    </resultMap>
    <resultMap id="PhotoLiteSelect" type="beanPhotoLite" extends="PhotoLite">
        <result column="FichierPhoto" property="oldNom"/>
        <result column="StockagePhoto" property="oldStockee"/>
    </resultMap>
    <resultMap id="CouvertureLite" type="beanCouvertureLite" extends="ImageLite">
        <id column="id_couverture" property="id"/>
        <result column="FichierCouverture" property="newNom"/>
        <result column="StockageCouverture" property="newStockee"/>
    </resultMap>
    <resultMap id="CouvertureLiteSelect" type="beanCouvertureLite" extends="CouvertureLite">
        <result column="FichierCouverture" property="oldNom"/>
        <result column="StockageCouverture" property="oldStockee"/>
    </resultMap>

    <select id="getListCouvertureLiteByEditionId" resultMap="CouvertureLiteSelect" resultOrdered="true">
        <![CDATA[
        select
            c.id_couverture, c.fichiercouverture, c.stockagecouverture, c.categorieimage, l.libelle as lb_categorieimage
        from
            couvertures c
            left join listes l on
                (c.categorieimage = l.ref and l.categorie = 6)
        where
            c.id_edition = #{id}
        order by
            l.ordre nulls last, c.ordre
        ]]>
    </select>
    <select id="getListPhotoLiteByParaBDId" resultMap="PhotoLiteSelect" resultOrdered="true">
        <![CDATA[
        select
            p.id_photo, p.fichierphoto, p.stockagephoto, p.categorieimage, l.libelle as lb_categorieimage
        from
            photos p
            left join listes l on
                (p.categorieimage = l.ref and l.categorie = 10)
        where
            p.id_parabd = #{id}
        order by
            p.ordre
        ]]>
    </select>
</mapper>