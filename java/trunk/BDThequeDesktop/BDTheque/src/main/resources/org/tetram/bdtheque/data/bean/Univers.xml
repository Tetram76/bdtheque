<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="org.tetram.bdtheque.data.dao.UniversDao">
    <resultMap id="UniversLite" type="beanUniversLite">
        <id column="id_univers" property="id"/>
        <result column="nomunivers" property="nomUnivers"/>
    </resultMap>
    <resultMap id="UniversFull" type="beanUnivers">
        <id column="id_univers" property="id"/>
        <result column="nomunivers" property="nomUnivers"/>
        <result column="description" property="description"/>
        <result column="siteweb" property="siteWeb"/>
        <association property="universParent" select="getUniversLiteById" column="id_univers_parent"/>
    </resultMap>

    <select id="getUniversLiteById" resultMap="UniversLite">
        <![CDATA[
        select
            id_univers, nomunivers
        from
            univers
        where
            id_univers = #{id}
        ]]>
    </select>
    <select id="getUniversById" resultMap="UniversFull">
        <![CDATA[
        select
            id_univers, nomunivers, id_univers_parent, description, siteweb
        from
            univers
        where
            id_univers = #{id}
        ]]>
    </select>
    <select id="getListUniversLiteByParaBDId" resultMap="UniversLite">
        <![CDATA[
        select
            u.*
        from
            univers u
            inner join parabd_univers pu on
                pu.id_univers = u.id_univers
        where
            pu.source_parabd = 1 and pu.id_parabd = #{id}
        ]]>
    </select>
    <select id="getListUniversLiteByAlbumId" resultMap="UniversLite">
        <![CDATA[
        select
            u.*
        from
            univers u
            inner join albums_univers au on
                au.id_univers = u.id_univers
        where
            au.source_album = 1 and au.id_album = #{id}
        ]]>
    </select>
    <select id="getListUniversLiteBySerieId" resultMap="UniversLite">
        <![CDATA[
        select
            u.*
        from
            univers u
            inner join series_univers su on
                su.id_univers = u.id_univers
        where
            su.id_serie = #{id}
        ]]>
    </select>
</mapper>